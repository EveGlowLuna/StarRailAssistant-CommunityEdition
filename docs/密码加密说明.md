# 密码加密功能说明

## 概述

本项目使用 Windows DPAPI (Data Protection API) 对配置文件中的敏感信息进行加密，与原 SRAFrontend 项目保持完全兼容。

## 加密内容

以下字段会被自动加密：
- `StartGamePassword` - 游戏登录密码
- `StartGameUsername` - 游戏登录用户名

## 加密方式

### 前端（Tauri/Rust）
1. 用户输入密码/用户名
2. 使用 Windows DPAPI `CryptProtectData` 加密
3. 转换为 Base64 字符串
4. 保存到配置文件 `%APPDATA%\SRA\configs\*.json`

### 后端（Python）
1. 从配置文件读取加密的 Base64 字符串
2. Base64 解码
3. 使用 Windows DPAPI `CryptUnprotectData` 解密
4. 使用明文密码进行登录

## 技术细节

- **加密范围**: `DataProtectionScope.CurrentUser` (仅当前用户可解密)
- **熵值**: 无 (null)
- **编码**: Base64
- **兼容性**: 与 C# `ProtectedData.Protect/Unprotect` 完全兼容

## 安全性

- 密码使用 Windows 用户凭据加密，只有当前 Windows 用户可以解密
- 即使配置文件被复制到其他电脑或其他用户账户，也无法解密
- 配置文件中不再存储明文密码

## 向后兼容

- 如果配置文件中存在旧的明文密码，加载时会尝试解密
- 解密失败时会保持原值（向后兼容旧配置）
- 下次保存时会自动加密

## 测试

运行加密模块测试：
```bash
cargo test --manifest-path src-tauri/Cargo.toml encryption::tests
```

## 注意事项

1. 此功能仅在 Windows 平台可用
2. 非 Windows 平台会使用简单的 Base64 编码（不加密）
3. 与原 SRA Python 后端完全兼容
